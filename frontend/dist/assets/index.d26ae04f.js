var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,n=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,r=(e,r)=>{for(var l in r||(r={}))t.call(r,l)&&n(e,l,r[l]);if(a)for(var l of a(r))s.call(r,l)&&n(e,l,r[l]);return e};import{u as l,a as c,r as o,M as m,L as i,B as p,C as u,A as d,p as E,S as h,b as y,H as _,c as f,P as g,d as b,f as v,e as N,g as w,I as x,h as S,i as O,j as k,k as I,l as C,m as P,n as T,o as z,q as H,X as L,s as R,T as U,t as G,v as j,w as $,R as B,x as A,y as M,z as D,D as F,E as V,F as q,G as W,J as Q,Q as J,K,N as X,O as Y,U as Z,V as ee}from"./vendor.3b480554.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const l=new URL(e,s);if(self[t].moduleMap[l])return a(self[t].moduleMap[l]);const c=new Blob([`import * as m from '${l}';`,`${t}.moduleMap['${l}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){r(new Error(`Failed to import: ${e}`)),n(o)},onload(){a(self[t].moduleMap[l]),n(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("/assets/");const te=({title:e,expenseButton:t=!1,goBackButton:a=!1})=>{const s=l(),n=c((e=>e.app.popupVisible));return o.createElement("div",{className:"header"},o.createElement("div",{className:"header__menu"},o.createElement(m,{className:"header__buttons__icon",fontSize:"large",onClick:()=>{var e;s({type:"TOGGLE_NAV",payload:e})}})),o.createElement("h1",null,e),o.createElement("div",{className:"header__buttons"},t&&o.createElement(i,{to:"/expenses"},o.createElement(p,{onClick:()=>{s((e=>({type:"TOGGLE_POPUP",payload:e}))())},colorScheme:"blue"},n?"x":"New expense")),a&&o.createElement(i,{to:"/expenses"},o.createElement(u,{color:"white",size:"lg"}))))};const ae=({message:e})=>o.createElement("div",{className:"message"},o.createElement(d,{src:e.user.photo}),o.createElement("div",{className:"message__info"},o.createElement("h4",null,e.user.name,o.createElement("span",{className:"message__timestamp"},e.message.timestamp)),o.createElement("p",null,e.message.message)));const se=e=>{var{channelName:n}=e,l=((e,n)=>{var r={};for(var l in e)t.call(e,l)&&n.indexOf(l)<0&&(r[l]=e[l]);if(null!=e&&a)for(var l of a(e))n.indexOf(l)<0&&s.call(e,l)&&(r[l]=e[l]);return r})(e,["channelName"]);return o.createElement("div",r({className:"channel"},l),o.createElement("h3",{className:"channel__roomName"},"# ",o.createElement("span",null,n)))};se.propTypes={channelName:E.PropTypes.string.isRequired},se.defaultProps={channelName:null};const ne=e=>({type:"LOGIN_USER",payload:e}),re=({user:e,mutate:t,channels:a})=>{const s=c((e=>e.app.navOpen)),n=l();return a?o.createElement(y,{w:220,className:`sidebar ${s&&"sidebar--mobileOn"}`},o.createElement("div",{className:"sidebar__user"},o.createElement("div",{className:"sidebar__userHeader"},o.createElement(d,{className:"sidebar__userHeader__avatar",src:e.photo}),o.createElement(_,{as:"h3",size:"xs"},e.name)),o.createElement(i,{to:"/notifications"},o.createElement(f,null))),o.createElement("div",{className:"sidebar__selector"},o.createElement(i,{to:"/expenses"},o.createElement("div",{className:"sidebar__selectorHeader"},o.createElement("h2",null,"Expenses"))),o.createElement("div",{className:"sidebar__selectorHeader--withoutHover"},o.createElement("h2",null,"Chat room"),o.createElement(g,{className:"sidebar__selectorHeader__icon",onClick:async()=>{const e=prompt("Enter a new channel name");e&&await b.post("/api/chat/channel",{channelName:e}),t()}})),o.createElement("div",{className:"sidebar__chatList"},a.map((({name:e,id:t})=>o.createElement(i,{to:`/chat/${t}`,key:t},o.createElement(se,{key:t,id:t,channelName:e})))))),o.createElement("div",{className:"sidebar__logout"},o.createElement(p,{onClick:()=>{n({type:"LOGOUT_USER",payload:null}),localStorage.removeItem("secret")},colorScheme:"pink"},"Logout"))):o.createElement(h,{color:"pink"})};re.propTypes={user:E.PropTypes.object.isRequired},re.defaultProps={user:null};const le=v.initializeApp({apiKey:"AIzaSyCku5ougEQOPYHi1zz4vplMIxjNp9FhG34",authDomain:"zip-app--222.firebaseapp.com",databaseURL:"https://zip-app--222.firebaseio.com",projectId:"zip-app--222",storageBucket:"zip-app--222.appspot.com",messagingSenderId:"1066062223453",appId:"1:1066062223453:web:a67fa2964f37dc7e7a15b4",measurementId:"G-J0Q86CJK6Q"}).firestore(),ce=v.auth();new v.auth.GoogleAuthProvider;const oe=new Date;const me=({channelId:e})=>{const{data:t,mutate:a}=N(`/api/chat/messages/${e}`),{register:s,handleSubmit:n,reset:r}=w(),l=c((e=>e.user.user));o.useEffect((()=>{a()}),[e]);return t?o.createElement(o.Fragment,null,o.createElement("div",{className:"chatBox"},o.createElement("div",{className:"chat__messages"},t.map((e=>o.createElement(ae,{key:e.message.id,message:e}))))),o.createElement("div",{className:"chat__input"},o.createElement("form",{onSubmit:n((async t=>{const{message:s}=t,n=oe.toString().split("+")[0];await b.post(`/api/chat/messages?userId=${l.id}`,{message:s,timestamp:n,channelId:e}),a(),r()}))},o.createElement(x,{size:"lg",name:"message",ref:s,disabled:!e,placeholder:"Start typing...",autoComplete:"off"})))):o.createElement(h,{color:"pink"})},ie=()=>{const{channelId:e}=S();return o.createElement("div",{className:"chat"},o.createElement(te,{title:"Chat"}),o.createElement(me,{channelId:e}))};const pe=({user:e,value:t})=>o.createElement("div",{className:"expense"},o.createElement("div",{className:"expense__user"},o.createElement(d,{src:e.photo}),o.createElement("p",null,e.name)),o.createElement("p",{className:"expense__total"},t,"pln"),o.createElement("div",{className:"expense__history"},o.createElement(i,{to:`/history/${e.id}`},o.createElement(O,{style:{color:"#fff"}}))));const ue=({user:e,users:t,mutate:a})=>{var s;const{register:n,handleSubmit:r,control:l,watch:c,reset:m}=w({defaultValues:{value:0,details:""}}),i=c("user"),u=c("value");return o.createElement(y,{className:"expensePopup",d:"flex",alignItems:"center"},o.createElement("form",{onSubmit:r((async t=>{const s=await b.post(`http://localhost:8080/api/expenses/${e.id}`,{values:t,timestamp:(new Date).toLocaleDateString()});m(),a(),console.log(s)}),(e=>{console.log(e)}))},o.createElement(k,{w:400,textColor:"white",direction:"column",placeItems:"center",spacing:2},o.createElement(I,{name:"user",control:l,as:o.createElement(C,{icon:o.createElement(d,{src:i&&(null==(s=t[i])?void 0:s.photo)}),placeholder:"Who owes you money?"},t.map((e=>o.createElement("option",{key:e.id,value:e.id},e.name))))}),o.createElement(P,null,o.createElement(T,{pointerEvents:"none",color:"gray.300",fontSize:"1.2em",children:"$"}),o.createElement(x,{name:"value",type:"number",step:"0.01",ref:n,placeholder:"How big is the expese?",textColor:"white"}),o.createElement(z,{children:u>0?o.createElement(H,{color:"green"}):0===u||""===u?null:o.createElement(L,{color:"red"})})),o.createElement(x,{name:"details",type:"text",ref:n,placeholder:"Describe your expense",mb:2}),o.createElement(p,{type:"submit",w:100,variant:"solid",colorScheme:"blue",textColor:"white"},"Add"))))};ue.propTypes={users:E.PropTypes.array};const de=()=>{const e=c((e=>e.app.popupVisible));l();const t=c((e=>e.user.user)),{data:a,mutate:s}=N(`/api/expenses?userId=${t.id}`);return a?o.createElement("div",{className:"expenses"},o.createElement(te,{title:"Expenses",expenseButton:!0}),e&&o.createElement(ue,{user:t,users:a.users,mutate:s}),o.createElement("div",{className:"expensesSection"},o.createElement("div",{className:"expensesHeader"},o.createElement("h3",{className:"expensesHeader__user"},"User"),o.createElement("h3",{className:"expensesHeader__total"},"Expense"),o.createElement("h3",{className:"expensesHeader__history"},"History")),o.createElement("div",{className:"expensesList"},a.expenses&&a.expenses.map((e=>o.createElement(pe,{key:e.user.id,user:e.user,value:e.value})))))):o.createElement(h,{color:"pink"})};const Ee=()=>{const{register:e,handleSubmit:t}=w(),a=l();o.useEffect((()=>{const e=localStorage.getItem("secret");if(e){const t=R(e);a(ne(t.userInfo))}}),[]);return o.createElement("div",{className:"login"},o.createElement(_,{as:"h1",fontSize:"6xl",isTruncated:!0,mb:1,colorScheme:"pink"},"Ultimate crew expense tracker ",o.createElement("br",null)),o.createElement("span",{className:"login__loginContainer__textSplit"},o.createElement(U,{fontSize:"4xl",mb:10,color:"rgb(31, 117, 196)"},"OG edition")),o.createElement(y,{maxWidth:600},o.createElement("form",{autoComplete:"off",onSubmit:t((async e=>{const{data:t}=await b.post("/api/users/login",e),{user:s,token:n}=t;s&&a(ne(s)),n&&localStorage.setItem("secret",n)}),(e=>console.log(e)))},o.createElement(x,{name:"email",ref:e,placeholder:"Email",type:"email",size:"lg",variant:"outline",mb:5}),o.createElement(x,{name:"password",ref:e,placeholder:"Password",type:"password",size:"lg",variant:"outline",mb:5}),o.createElement(G,{spacing:"6"},o.createElement(p,{type:"submit",colorScheme:"blue",variant:"solid"},"Login"),o.createElement(i,{to:"/register"},o.createElement(p,{variant:"outline",colorScheme:"pink"},"Register"))))))};const he=({user:e})=>{const[t,a]=o.useState([]),{id:s}=S(),{data:n,mutate:r}=N(`/api/expenses/history/${s}?userId=${e.id}`);o.useEffect((()=>{if(n){const{inHistory:e,outHistory:t}=n,s=e.concat(t).sort(((e,t)=>t.id-e.id));a(s)}}),[n]);return n?o.createElement("div",{className:"history"},o.createElement(te,{title:"History",goBackButton:!0}),o.createElement("div",{className:"historySection"},o.createElement("div",{className:"historyHeader"},o.createElement("h3",{className:"historyHeader__user"},"User"),o.createElement("h3",{className:"historyHeader__expense"},"Expense"),o.createElement("h3",{className:"historyHeader__timestamp"},"Time"),o.createElement("h3",{className:"historyHeader__about"},"About"),o.createElement("div",{className:"historyHeader__blank"})),o.createElement("div",{className:"historyList"},t.map((t=>o.createElement("div",{className:"tableRow",key:t.id},o.createElement("div",{className:"tableRow__user"},o.createElement(d,{src:t.photo})),o.createElement("p",{className:"tableRow__expense"},t.value),o.createElement("p",{className:"tableRow__timestamp"},t.timestamp),o.createElement("p",{className:"tableRow__about"},t.details),o.createElement("div",{className:"tableRow__blank"},o.createElement(j,{size:20,color:"#e84545",style:{cursor:"pointer"},onClick:()=>(async t=>{console.log(t),console.log(e.id);try{await b.post("/api/expenses/history/delete-request",{expenseId:t,user:e.id})}catch(a){console.error(a)}})(t.id)})))))))):o.createElement(h,{color:"pink"})};he.propTypes={historyEl:E.PropTypes.object,historyOf:E.PropTypes.object};const ye=({children:e})=>o.createElement("div",{className:"utilityCard"},e),_e=({users:e})=>{c((e=>e.app.notifications));const t=l();return o.useEffect((()=>{((e,t)=>{for(const a of e)le.collection("users").doc(a.uid).collection("expensesFrom").doc(ce.currentUser.uid).collection(ce.currentUser.uid).onSnapshot((e=>e.docs.forEach((e=>{e.data().deletion_request&&t({type:"ADD_NOTIFICATION",payload:e.data()})}))))})(e,t)}),[]),o.createElement("div",{className:"history"},o.createElement(te,{title:"Notifications",goBackButton:!0}),o.createElement(ye,null,o.createElement("p",null,"tester")))},fe=()=>{const{register:e,handleSubmit:t}=w();l();return o.createElement("div",{className:"login"},o.createElement(_,{as:"h1",fontSize:"6xl",isTruncated:!0,mb:1},"Ultimate crew expense tracker ",o.createElement("br",null)),o.createElement(U,{fontSize:"4xl",mb:10,colorScheme:"blue",color:"rgb(31, 117, 196)"},"OG edition"),o.createElement(y,{maxWidth:600},o.createElement("form",{autoComplete:"off",onSubmit:t((async e=>{console.log(e),await b.post("http://localhost:8080/api/users/register",e)}),(e=>console.log(e)))},o.createElement(x,{name:"email",ref:e,placeholder:"Email",type:"email",size:"lg",variant:"outline",mb:5}),o.createElement(x,{name:"password",ref:e,placeholder:"Password",type:"password",size:"lg",variant:"outline",mb:5}),o.createElement(x,{name:"confirmPassword",ref:e,placeholder:"Confirm password",type:"password",size:"lg",variant:"outline",mb:5}),o.createElement(G,{spacing:"6"},o.createElement(p,{type:"submit",colorScheme:"blue",variant:"solid"},"Register"),o.createElement(i,{to:"/login"},o.createElement(p,{variant:"outline",colorScheme:"pink"},"Login"))))))},ge=()=>{const e=c((e=>e.user.user)),{data:t,mutate:a}=N("/api/chat/channel");return t?o.createElement("div",{className:"app"},o.createElement($,null,e?o.createElement(o.Fragment,null,o.createElement(B,{to:"/expenses"}),o.createElement(re,{user:e,mutate:a,channels:t}),o.createElement(M,null,o.createElement(A,{path:"/expenses"},o.createElement(de,null)),o.createElement(A,{path:"/history/:id"},o.createElement(he,{user:e})),o.createElement(A,{path:"/chat/:channelId"},o.createElement(ie,{user:e})),o.createElement(A,{path:"/notifications"},o.createElement(_e,null)))):o.createElement(o.Fragment,null,o.createElement(B,{to:"/login"}),o.createElement(A,{path:"/login",component:Ee}),o.createElement(A,{path:"/register",component:fe})))):o.createElement(h,{color:"pink"})},be={channelId:"xxiO3R5c7TbsnEXvMnml",channelName:"PFD"},ve={user:null},Ne={popupVisible:!1,navOpen:!1,notifications:[]},we=F(D({user:(e=ve,t)=>{switch(t.type){case"LOGIN_USER":return r(r({},e),{user:t.payload});case"LOGOUT_USER":return r(r({},e),{user:null});default:return e}},channel:(e=be,t)=>{switch(t.type){case"SET_CHANNEL":return r(r({},e),{channelId:t.payload.channelId,channelName:t.payload.channelName});default:return e}},app:(e=Ne,t)=>{switch(t.type){case"TOGGLE_POPUP":return r(r({},e),{popupVisible:!e.popupVisible});case"TOGGLE_NAV":return r(r({},e),{navOpen:!e.navOpen});case"ADD_NOTIFICATION":return r(r({},e),{notifications:[...e.notifications,t.payload]});default:return e}}}),V(q(W)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));const xe=Q({config:{initialColorMode:"dark",useSystemColorMode:!1}}),Se=new J;K.render(o.createElement(o.StrictMode,null,o.createElement(X,{store:we},o.createElement(Y,{client:Se},o.createElement(Z,null,o.createElement(ee,{initialColorMode:xe.config.initialColorMode}),o.createElement(ge,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}));
