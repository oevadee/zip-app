var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,l=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,s=(e,s)=>{for(var r in s||(s={}))t.call(s,r)&&l(e,r,s[r]);if(a)for(var r of a(s))n.call(s,r)&&l(e,r,s[r]);return e};import{u as r,a as c,b as o,r as m,M as i,L as u,B as p,C as E,A as d,p as h,S as g,c as y,H as f,d as v,P as b,D as w,e as N,f as _,g as x,h as S,i as k,j as C,k as O,l as I,I as T,m as $,n as P,o as L,y as R,q as U,s as z,F as j,t as G,N as H,v as M,w as B,x as V,z as A,X as D,E as F,G as W,J as q,T as Y,K as J,O as K,Q,R as X,U as Z,V as ee,W as te,Y as ae,Z as ne,_ as le,$ as se,a0 as re,a1 as ce,a2 as oe,a3 as me,a4 as ie,a5 as ue,a6 as pe,a7 as Ee,a8 as de,a9 as he,aa as ge,ab as ye,ac as fe,ad as ve,ae as be,af as we,ag as Ne,ah as _e,ai as xe,aj as Se,ak as ke}from"./vendor.05d17380.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),l=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,s)=>{const r=new URL(e,n);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const c=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){s(new Error(`Failed to import: ${e}`)),l(o)},onload(){a(self[t].moduleMap[r]),l(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("/assets/");const Ce=e=>({type:"TOGGLE_NAV",payload:e}),Oe=({title:e,expenseButton:t=!1,goBackButton:a=!1})=>{const n=r(),l=c((e=>e.app.popupVisible)),s=o({base:!0,md:!1});return m.createElement("div",{className:"header"},m.createElement("div",{className:"header__menu"},s&&m.createElement(i,{className:"header__buttons__icon",fontSize:"large",onClick:()=>{n(Ce())}})),!s&&m.createElement("h1",null,e),m.createElement("div",{className:"header__buttons"},t&&m.createElement(u,{to:"/expenses"},m.createElement(p,{onClick:()=>{n((e=>({type:"TOGGLE_POPUP",payload:e}))())},colorScheme:"blue"},l?"x":"New expense")),a&&m.createElement(u,{to:"/expenses"},m.createElement(E,{color:"white",size:"lg"}))))};const Ie=({message:e})=>m.createElement("div",{className:"message"},m.createElement(d,{src:e.user.photo}),m.createElement("div",{className:"message__info"},m.createElement("h4",null,e.user.name,m.createElement("span",{className:"message__timestamp"},e.message.timestamp)),m.createElement("p",null,e.message.message)));const Te=e=>({type:"LOGIN_USER",payload:e});var $e="www.zip.waw.pl";const Pe=({user:e,mutate:t,channels:a})=>{const n=r();return a?(console.log(a),m.createElement(y,{maxW:200,minW:200,className:"sidebar"},m.createElement("div",{className:"sidebar__user"},m.createElement("div",{className:"sidebar__userHeader"},m.createElement(d,{className:"sidebar__userHeader__avatar",src:e.photo}),m.createElement(f,{as:"h4",size:"xs"},e.name))),m.createElement("div",{className:"sidebar__selector"},m.createElement(Le,{channelName:"Expenses",url:"/expenses"}),m.createElement(Le,{channelName:"Settings",url:"/settings"}),m.createElement(Le,{channelName:"Chat room",icon:!0,onClick:async()=>{const e=prompt("Enter a new channel name");e&&await v.post(`http://${$e}/api/chat/channel`,{channelName:e}),t()}}),m.createElement("div",{className:"sidebar__chatList"},a.map((({name:e,id:t})=>m.createElement(Le,{key:t,id:t,channelName:e,url:`/chat/${t}`}))))),m.createElement("div",{className:"sidebar__logout"},m.createElement(p,{onClick:()=>{n({type:"LOGOUT_USER",payload:null}),localStorage.removeItem("secret")},colorScheme:"pink"},"Logout")))):m.createElement(g,{color:"pink"})};Pe.propTypes={user:h.PropTypes.object.isRequired},Pe.defaultProps={user:null};const Le=e=>{var{channelName:l,icon:r=!1,url:c=null,onChannelClick:o}=e,i=((e,l)=>{var s={};for(var r in e)t.call(e,r)&&l.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&a)for(var r of a(e))l.indexOf(r)<0&&n.call(e,r)&&(s[r]=e[r]);return s})(e,["channelName","icon","url","onChannelClick"]);return m.createElement(u,{to:c},m.createElement("div",{className:"channel"+(c?"":"--withoutHover"),onClick:o},m.createElement("h2",null,l),r&&m.createElement(b,s({className:"channel__icon"},i))))};Le.propTypes={channelName:h.PropTypes.string.isRequired},Le.defaultProps={channelName:null};const Re=({user:e,mutate:t,channels:a})=>{const n=c((e=>e.app.navOpen)),l=r(),s=m.useRef(),i=o({base:!1}),u=()=>{l(Ce())};return a?m.createElement(w,{isOpen:i||n,placement:"left",onClose:u,finalFocusRef:s,size:"xs"},m.createElement(N,null,m.createElement(_,{className:"sidebar"},!i&&m.createElement(x,null),m.createElement(S,null,m.createElement("div",{className:"sidebar__userHeader"},m.createElement(d,{className:"sidebar__userHeader__avatar",src:e.photo}),m.createElement(f,{as:"h4",size:"xs"},e.name))),m.createElement(k,{p:0},m.createElement(Le,{channelName:"Expenses",url:"/expenses",onChannelClick:u}),m.createElement(Le,{channelName:"Settings",url:"/settings",onChannelClick:u}),m.createElement(Le,{channelName:"Chat room",icon:!0,onClick:async()=>{const e=prompt("Enter a new channel name");e&&await v.post(`http://${$e}/api/chat/channel`,{channelName:e}),t()}}),m.createElement("div",{className:"sidebar__chatList"},a.map((({name:e,id:t})=>m.createElement(Le,{id:t,channelName:e,url:`/chat/${t}`,onChannelClick:u}))))),m.createElement(C,null,m.createElement("div",{className:"sidebar__logout"},m.createElement(p,{onClick:()=>{l({type:"LOGOUT_USER",payload:null}),localStorage.removeItem("secret")},colorScheme:"pink"},"Logout")))))):m.createElement(g,{color:"pink"})};const Ue=new Date;const ze=({channelId:e})=>{const{data:t,mutate:a}=O(`http://${$e}/api/chat/messages/${e}`),{register:n,handleSubmit:l,reset:s}=I(),r=c((e=>e.user.user));m.useEffect((()=>{a()}),[e]);return t?m.createElement(m.Fragment,null,m.createElement("div",{className:"chatBox"},m.createElement("div",{className:"chat__messages"},t.map((e=>m.createElement(Ie,{key:e.message.id,message:e}))))),m.createElement("div",{className:"chat__input"},m.createElement("form",{onSubmit:l((async t=>{const{message:n}=t,l=Ue.toString().split("+")[0];await v.post(`http://${$e}/api/chat/messages?userId=${r.id}`,{message:n,timestamp:l,channelId:e}),a(),s()}))},m.createElement(T,{size:"lg",name:"message",ref:n,disabled:!e,placeholder:"Start typing...",autoComplete:"off"})))):m.createElement(g,{color:"pink"})},je=()=>{const{channelId:e}=$();return m.createElement(y,{className:"chat"},m.createElement(Oe,{title:"Chat"}),m.createElement(ze,{channelId:e}))};const Ge=P().shape({user:L().required(),value:L().required("You can't add an empty expense"),details:L().max(512,"Description is to long. You can use 512 characters.")}),He=({user:e,users:t,mutate:a})=>{var n;const{register:l,handleSubmit:s,control:r,watch:c,reset:o,errors:i}=I({defaultValues:{user:"",value:"",details:""},resolver:R.yupResolver(Ge)}),u=c("user"),E=c("value");return m.createElement(y,{className:"expensePopup",d:"flex",alignItems:"center"},m.createElement(y,{w:{base:"100%",md:"80%"},maxW:600},m.createElement("form",{onSubmit:s((async t=>{console.log(t),await v.post(`http://${$e}/api/expenses/${e.id}`,{values:t,timestamp:(new Date).toLocaleDateString()}),o(),a()}))},m.createElement(U,{textColor:"white",direction:"column",placeItems:"center",spacing:2},m.createElement(z,{name:"user",control:r,as:m.createElement(j,{isInvalid:i.user},m.createElement(G,{icon:m.createElement(d,{src:u&&(null==(n=t[u])?void 0:n.photo)}),placeholder:"Who owes you money?"},t.map((e=>m.createElement("option",{key:e.id,value:e.id},e.name)))))}),m.createElement(z,{name:"value",control:r,as:m.createElement(j,{isInvalid:i.value},m.createElement(H,{max:1e4,w:"100%"},m.createElement(M,{pointerEvents:"none",color:"gray.300",fontSize:"1.2em",children:"$"}),m.createElement(B,{pl:8}),m.createElement(V,{mr:6,children:E>0?m.createElement(A,{color:"green"}):0===E||""===E?null:m.createElement(D,{color:"red"})}),m.createElement(F,null,m.createElement(W,null),m.createElement(q,null))))}),m.createElement(T,{name:"details",type:"text",ref:l,placeholder:"Describe your expense"}),m.createElement(p,{mt:2,type:"submit",w:100,variant:"solid",colorScheme:"blue",textColor:"white"},"Add")))))};He.propTypes={users:h.PropTypes.array};const Me=({children:e})=>m.createElement("div",{className:"card"},e),Be=()=>{const e=c((e=>e.app.popupVisible));r();const t=c((e=>e.user.user)),a=o({base:!1,md:!0}),{data:n,mutate:l}=O(`http://${$e}/api/expenses?userId=${t.id}`);return n?(console.log(n.expenses),m.createElement("div",{className:"expenses"},m.createElement(Oe,{title:"Expenses",expenseButton:!0}),e&&m.createElement(He,{user:t,users:n.users,mutate:l}),m.createElement(Me,null,m.createElement(Y,{size:"lg"},m.createElement(J,null,m.createElement(K,null,m.createElement(Q,{w:100}),a&&m.createElement(Q,null,"User"),m.createElement(Q,{isNumeric:!0},"Expense"),m.createElement(Q,{isNumeric:!0},"History"))),m.createElement(X,null,n.expenses&&n.expenses.map((e=>m.createElement(K,{key:e.user.id},a?m.createElement(Z,{w:100},m.createElement(d,{src:e.user.photo})):m.createElement(Z,{p:5,w:100},m.createElement(d,{src:e.user.photo})),a&&m.createElement(Z,null,e.user.name),m.createElement(Z,{isNumeric:!0},e.value),m.createElement(Z,{isNumeric:!0},m.createElement(u,{style:{display:"flex",justifyContent:"flex-end",marginRight:23},to:`/history/${e.user.id}`},m.createElement(ee,{style:{color:"#fff"}}))))))))))):m.createElement(g,{color:"pink"})};const Ve=()=>{const{register:e,handleSubmit:t}=I(),a=r();m.useEffect((()=>{const e=localStorage.getItem("secret");if(e){const t=te(e);a(Te(t.userInfo))}}),[]);return m.createElement("div",{className:"login"},m.createElement(f,{as:"h1",fontSize:["2xl","3xl","4xl","5xl"],isTruncated:!0,mb:1,colorScheme:"pink"},"Ultimate crew expense tracker ",m.createElement("br",null)),m.createElement("span",{className:"login__loginContainer__textSplit"},m.createElement(ae,{fontSize:["xl","2xl","2xl","4xl"],mb:10,color:"rgb(31, 117, 196)"},"OG edition")),m.createElement(y,{maxWidth:600},m.createElement("form",{autoComplete:"off",onSubmit:t((async e=>{const{data:t}=await v.post(`http://${$e}/api/users/login`,e),{user:n,token:l}=t;n&&a(Te(n)),l&&localStorage.setItem("secret",l)}),(e=>console.log(e)))},m.createElement(T,{name:"email",ref:e,placeholder:"Email",type:"email",size:"lg",variant:"outline",mb:5}),m.createElement(T,{name:"password",ref:e,placeholder:"Password",type:"password",size:"lg",variant:"outline",mb:5}),m.createElement(ne,{spacing:"6"},m.createElement(p,{type:"submit",colorScheme:"blue",variant:"solid"},"Login"),m.createElement(u,{to:"/register"},m.createElement(p,{disabled:!0,variant:"outline",colorScheme:"pink"},"Register"))))))};const Ae=({user:e})=>{const[t,a]=m.useState([]),{id:n}=$(),{data:l,mutate:s}=O(`http://${$e}/api/expenses/history/${n}?userId=${e.id}`);m.useEffect((()=>{if(l){const{inHistory:e,outHistory:t}=l,n=e.concat(t).sort(((e,t)=>t.id-e.id));a(n)}}),[l]);return l?m.createElement("div",{className:"history"},m.createElement(Oe,{title:"History",goBackButton:!0}),m.createElement(Me,null,m.createElement(Y,{size:"lg",colorScheme:"blue"},m.createElement(J,null,m.createElement(K,null,m.createElement(Q,{w:50},"User"),m.createElement(Q,{w:150,isNumeric:!0},"Expense"),m.createElement(Q,null,"Time"),m.createElement(Q,null,"About"),m.createElement(Q,null))),m.createElement(X,null,t.map((t=>m.createElement(K,{key:t.id},m.createElement(Z,{w:50},m.createElement(d,{src:t.photo})),m.createElement(Z,{w:150,isNumeric:!0},t.value),m.createElement(Z,null,t.timestamp),m.createElement(Z,null,t.details),m.createElement(Z,null,m.createElement(le,{size:20,color:"#e84545",style:{cursor:"pointer"},onClick:()=>(async t=>{console.log(t),console.log(e.id);try{const{data:a}=await v.post(`http://${API_HOST}/api/expenses/history/delete-request`,{expenseId:t,user:e.id})}catch(a){console.error(a)}})(t.id)}))))))))):m.createElement(g,{color:"pink"})};Ae.propTypes={historyEl:h.PropTypes.object,historyOf:h.PropTypes.object};const De=({children:e})=>m.createElement(y,{p:5},e);const Fe=({user:e})=>{const[t,a]=m.useState(!1),[n,l]=m.useState(null),{register:s,handleSubmit:r}=I({defaultValues:{password:"",confirmPassword:""}});return console.log(n),m.createElement("div",{className:"settings"},m.createElement(Oe,{title:"Settings"}),m.createElement(Me,null,m.createElement(De,null,m.createElement(f,{size:"md"},"Change your password")),m.createElement(se,null),m.createElement(De,null,m.createElement("form",{onSubmit:r((async t=>{a(!0);try{const n=await v.put(`http://${$e}/api/users/profile?userId=${e.id}`,t);a(!1),l(n),setTimeout((()=>{l(null)}),3e3)}catch(n){a(!1),l(n.response),setTimeout((()=>{l(null)}),3e3)}}))},m.createElement(j,{mb:4},m.createElement(re,null,"Password"),m.createElement(T,{ref:s,type:"password",name:"password"})),m.createElement(j,{mb:4},m.createElement(re,null,"Confirm Password"),m.createElement(T,{ref:s,type:"password",name:"confirmPassword"}),m.createElement(ce,null,"We'll never share your email.")),m.createElement(p,{isLoading:t,loadingText:"Submitting",colorScheme:"teal",variant:"solid",type:"submit",colorScheme:"blue"},"Submit")))),n&&m.createElement(oe,{mt:4,status:200===n.status?"success":"warning",variant:"subtle"},m.createElement(me,null),n.data.message||n.statusText))},We=()=>{const e=c((e=>e.user.user)),{data:t,mutate:a}=O("http://www.zip.waw.pl/api/chat/channel"),n=o({base:!1,md:!0}),l=c((e=>e.app.navOpen));return t?m.createElement("div",{className:"app"},m.createElement(ie,null,e?m.createElement(m.Fragment,null,m.createElement(ue,{to:"/expenses"}),n&&m.createElement(Pe,{user:e,mutate:a,channels:t}),l&&m.createElement(Re,{user:e,mutate:a,channels:t}),m.createElement(Ee,null,m.createElement(pe,{path:"/expenses"},m.createElement(Be,null)),m.createElement(pe,{path:"/settings"},m.createElement(Fe,{user:e})),m.createElement(pe,{path:"/history/:id"},m.createElement(Ae,{user:e})),m.createElement(pe,{path:"/chat/:channelId"},m.createElement(je,{user:e})))):m.createElement(m.Fragment,null,m.createElement(ue,{to:"/login"}),m.createElement(pe,{path:"/login",component:Ve})))):m.createElement(g,{color:"pink"})},qe={channelId:"xxiO3R5c7TbsnEXvMnml",channelName:"PFD"},Ye={user:null},Je={popupVisible:!1,navOpen:!1,notifications:[]},Ke=he(de({user:(e=Ye,t)=>{switch(t.type){case"LOGIN_USER":return s(s({},e),{user:t.payload});case"LOGOUT_USER":return s(s({},e),{user:null});default:return e}},channel:(e=qe,t)=>{switch(t.type){case"SET_CHANNEL":return s(s({},e),{channelId:t.payload.channelId,channelName:t.payload.channelName});default:return e}},app:(e=Je,t)=>{switch(t.type){case"TOGGLE_POPUP":return s(s({},e),{popupVisible:!e.popupVisible});case"TOGGLE_NAV":return s(s({},e),{navOpen:!e.navOpen});case"ADD_NOTIFICATION":return s(s({},e),{notifications:[...e.notifications,t.payload]});default:return e}}}),ge(ye(fe)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));const Qe=ve({config:{initialColorMode:"dark",useSystemColorMode:!1}}),Xe=new be;we.render(m.createElement(m.StrictMode,null,m.createElement(Ne,{store:Ke},m.createElement(_e,{client:Xe},m.createElement(xe,null,m.createElement(Se,null),m.createElement(ke,{initialColorMode:Qe.config.initialColorMode}),m.createElement(We,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}));
