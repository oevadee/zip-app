var e=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,s=Object.assign;import{u as n,a as l,r,M as c,L as o,A as i,b as m,p,f as u,S as d,P as E,c as h,d as y,C as N,B as _,R as b,e as v,g,h as f,i as x,j as S,k as O,t as k,l as w,m as P}from"./vendor.647d639d.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,l)=>{const r=new URL(e,s);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const c=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){l(new Error(`Failed to import: ${e}`)),n(o)},onload(){a(self[t].moduleMap[r]),n(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("/assets/");const T=e=>({type:"TOGGLE_POPUP",payload:e}),C=e=>({type:"TOGGLE_NAV",payload:e}),U=({title:e,expenseButton:t=!1,goBackButton:a=!1})=>{const s=n(),m=l((e=>e.app.popupVisible));return r.createElement("div",{className:"header"},r.createElement("div",{className:"header__menu"},r.createElement(c,{className:"header__buttons__icon",fontSize:"large",onClick:()=>{s(C())}})),r.createElement("h1",null,e),r.createElement("div",{className:"header__buttons"},t&&r.createElement(o,{to:"/expenses"},r.createElement(H,{text:m?"x":"New expense",onClick:()=>{s(T())}})),a&&r.createElement(o,{to:"/expenses"},r.createElement(i,{className:"header__buttons__icon",fontSize:"large"}))))};const R=({timestamp:e,message:t,user:a})=>r.createElement("div",{className:"message"},r.createElement(m,{src:a.photo}),r.createElement("div",{className:"message__info"},r.createElement("h4",null,a.displayName,r.createElement("span",{className:"message__timestamp"},e)),r.createElement("p",null,t)));const L=({id:e,channelName:t})=>{const a=n();return r.createElement("div",{className:"channel",onClick:()=>{a({type:"SET_CHANNEL",payload:{channelId:e,channelName:t}}),a(C())}},r.createElement("h3",{className:"channel__roomName"},"# ",r.createElement("span",null,t)))};L.propTypes={id:p.PropTypes.string.isRequired,channelName:p.PropTypes.string.isRequired,setMobileNavOpen:p.PropTypes.func},L.defaultProps={channelId:null,channelName:null};const H=n=>{var{primary:l=!0,text:c,backgroundColor:o}=n,i=((s,n)=>{var l={};for(var r in s)e.call(s,r)&&n.indexOf(r)<0&&(l[r]=s[r]);if(null!=s&&t)for(var r of t(s))n.indexOf(r)<0&&a.call(s,r)&&(l[r]=s[r]);return l})(n,["primary","text","backgroundColor"]);return r.createElement("button",s({type:"button",className:l?"button":["button","button--secondary"].join(" "),style:o&&{backgroundColor:o}},i),c)};H.propTypes={primary:p.bool,text:p.string.isRequired,backgroundColor:p.string,onClick:p.func},H.defaultProps={backgroundColor:null,primary:!0,onClick:void 0};const I=u.initializeApp({apiKey:"AIzaSyCku5ougEQOPYHi1zz4vplMIxjNp9FhG34",authDomain:"zip-app--222.firebaseapp.com",databaseURL:"https://zip-app--222.firebaseio.com",projectId:"zip-app--222",storageBucket:"zip-app--222.appspot.com",messagingSenderId:"1066062223453",appId:"1:1066062223453:web:a67fa2964f37dc7e7a15b4",measurementId:"G-J0Q86CJK6Q"}).firestore(),j=u.auth(),G=new u.auth.GoogleAuthProvider,B=({user:e})=>{const[t,a]=r.useState([]),s=l((e=>e.app.navOpen)),c=n();r.useEffect((()=>{I.collection("channels").onSnapshot((e=>a(e.docs.map((e=>({id:e.id,channel:e.data()}))))))}),[]);const i=()=>{c(C())};return r.createElement("div",{className:"sidebar "+(s?"sidebar--mobileOn":"")},r.createElement("div",{className:"sidebar__user"},r.createElement("div",{className:"sidebar__userHeader"},r.createElement(m,{src:e.photo}),r.createElement("h3",null,e.displayName)),r.createElement(d,null)),r.createElement("div",{className:"sidebar__selector"},r.createElement(o,{to:"/expenses"},r.createElement("div",{className:"sidebar__selectorHeader",onClick:i},r.createElement("h2",null,"Expenses"))),r.createElement("div",{className:"sidebar__selectorHeader--withoutHover"},r.createElement("h2",null,"Chat room"),r.createElement(E,{onClick:()=>{const e=prompt("Enter a new channel name");e&&I.collection("channels").add({channelName:e})}})),r.createElement("div",{className:"sidebar__chatList"},t.map((({channel:e,id:t})=>r.createElement(o,{to:`/chat/${t}`,key:t},r.createElement(L,{key:t,id:t,channelName:e.channelName,onClick:i})))))),r.createElement("div",{className:"sidebar__logout"},r.createElement(H,{primary:!1,text:"Logout",onClick:()=>j.signOut()})))};B.propTypes={user:p.PropTypes.object.isRequired},B.defaultProps={user:null};const M=new Date,F=({user:e})=>{const[t,a]=r.useState([]),[s,n]=r.useState(""),{channelId:l}=h(),{register:c,handleSubmit:o,reset:i}=y(),m=M.toString().split("+")[0];r.useEffect((()=>{l&&I.collection("channels").doc(l).collection("messages").orderBy("timestamp","desc").onSnapshot((e=>a(e.docs.map((e=>e.data()))))),I.collection("channels").doc(l).onSnapshot((e=>n(e.data().channelName)))}),[l]);return r.createElement("div",{className:"chat"},r.createElement(U,{title:"Chat"}),r.createElement("div",{className:"chat__messages"},t.map(((e,t)=>r.createElement(R,{user:e.user,key:t,timestamp:e.timestamp,message:e.message})))),r.createElement("div",{className:"chat__input"},r.createElement(E,{fontSize:"large"}),r.createElement("form",{onSubmit:o((t=>{I.collection("channels").doc(l).collection("messages").add({message:t.message,timestamp:m,user:e}),i()}))},r.createElement("input",{name:"message",ref:c,disabled:!l,placeholder:`Message #${s}`}),r.createElement("button",{className:"chat__inputButton",type:"submit"},"Send Message"))))};const z=({user:e})=>{const[t,a]=r.useState(0);return n(),r.useEffect((()=>{e&&I.collection("users").doc(j.currentUser.uid).collection("expensesFrom").doc(e.uid).collection(e.uid).orderBy("timestamp","desc").onSnapshot((e=>{const t=e.docs.map((e=>e.data().value)).reduce(((e,t)=>Number(e)+Number(t)));a(t)}))}),[e]),r.createElement("div",{className:"expense"},r.createElement("div",{className:"expense__user"},r.createElement(m,{src:e.photo}),r.createElement("p",null,e.displayName)),r.createElement("p",{className:"expense__total"},String(t).split(".")[0],"pln"),r.createElement("div",{className:"expense__history"},r.createElement(o,{to:`/history/${e.uid}`},r.createElement(N,{style:{color:"#fff"}}))))};z.propTypes={user:p.PropTypes.object.isRequired},z.defaultProps={user:null};const A=({users:e})=>{const[t,a]=r.useState(null),[s,l]=r.useState(null),[c,o]=r.useState(0),[i,p]=r.useState(""),d=r.useRef(0),E=n();return r.createElement("div",{className:"expensePopup"},r.createElement("div",{className:"expensePopup__userSelector",ref:d},e.filter((e=>e.uid!==j.currentUser.uid)).map(((e,n)=>r.createElement(m,{key:e.uid,src:e.photo,onClick:()=>{t?(d.current.childNodes[s].style.opacity=.3,a(e.uid),d.current.childNodes[n].style.opacity=1,l(n)):(a(e.uid),d.current.childNodes[n].style.opacity=1,l(n))}})))),r.createElement("div",{className:"expensePopup__expenseValue"},r.createElement("input",{type:"number",value:c,onChange:e=>o(e.target.value),placeholder:"How big is the expese?"}),r.createElement("input",{type:"text",value:i,onChange:e=>p(e.target.value),placeholder:"Describe your expense"}),r.createElement(H,{text:"Add",onClick:()=>{t&&(I.collection("users").doc(j.currentUser.uid).collection("expensesFrom").doc(t).collection(t).add({value:c,aboutTransaction:i,timestamp:u.firestore.FieldValue.serverTimestamp()}),I.collection("users").doc(t).collection("expensesFrom").doc(j.currentUser.uid).collection(j.currentUser.uid).add({value:-c,aboutTransaction:i,timestamp:u.firestore.FieldValue.serverTimestamp()}),o(0),a(""),d.current.childNodes[s].style.opacity=.3,E(T))}})))};A.propTypes={users:p.PropTypes.array};const V=()=>{const e=l((e=>e.app.popupVisible)),[t,a]=r.useState([]);return r.useEffect((()=>{I.collection("users").onSnapshot((e=>{a(e.docs.map((e=>e.data())))}))}),[]),r.createElement("div",{className:"expenses"},r.createElement(U,{title:"Expenses",expenseButton:!0}),e&&r.createElement(A,{users:t}),r.createElement("div",{className:"expensesSection"},r.createElement("div",{className:"expensesHeader"},r.createElement("h3",{className:"expensesHeader__user"},"User"),r.createElement("h3",{className:"expensesHeader__total"},"Expense"),r.createElement("h3",{className:"expensesHeader__history"},"History")),r.createElement("div",{className:"expensesList"},t.filter((e=>e.uid!==j.currentUser.uid)).map((e=>r.createElement(z,{key:e.uid,user:e}))))))};z.propTypes={},z.defaultProps={};const $=()=>r.createElement("div",{className:"login"},r.createElement("div",{className:"login__loginContainer"},r.createElement("h1",null,"Ultimate crew expense tracker ",r.createElement("br",null),r.createElement("span",{style:{color:"rgb(185, 136, 246)"}},"OG edition")),r.createElement(H,{text:"login",onClick:()=>{j.signInWithPopup(G).catch((e=>alert(e.message)))}})));const D=({historyEl:e,historyOf:t})=>{const{id:a}=h(),[s,n]=r.useState([]),[l,c]=r.useState(null);return r.useEffect((()=>{I.collection("users").doc(j.currentUser.uid).collection("expensesFrom").doc(a).collection(a).orderBy("timestamp","desc").onSnapshot((e=>{n(e.docs.map((e=>e.data())))})),I.collection("users").doc(a).onSnapshot((e=>{c(e.data())}))}),[a]),r.createElement("div",{className:"history"},r.createElement(U,{title:"History",goBackButton:!0}),r.createElement("div",{className:"historySection"},r.createElement("div",{className:"historyHeader"},r.createElement("h3",{className:"historyHeader__user"},"User"),r.createElement("h3",{className:"historyHeader__expense"},"Expense"),r.createElement("h3",{className:"historyHeader__timestamp"},"Time"),r.createElement("h3",{className:"historyHeader__about"},"About")),r.createElement("div",{className:"historyList"},s.map((e=>{var t;return r.createElement("div",{className:"tableRow",key:e.timestamp},r.createElement("div",{className:"tableRow__user"},r.createElement(m,{src:l&&l.photo})),r.createElement("p",{className:"tableRow__expense"},e.value),r.createElement("p",{className:"tableRow__timestamp"},new Date(null==(t=e.timestamp)?void 0:t.toDate()).toLocaleDateString()),r.createElement("p",{className:"tableRow__about"},e.aboutTransaction))})))))};D.propTypes={historyEl:p.PropTypes.object,historyOf:p.PropTypes.object};function q(){const[e,t]=r.useState(!1),a=n(),s=l((e=>e.user.user));return r.useEffect((()=>{j.onAuthStateChanged((e=>{e?(a((e=>({type:"LOGIN_USER",payload:e}))({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName})),I.collection("users").doc(e.uid).set({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName})):a({type:"LOGOUT_USER",payload:null})}))}),[]),r.createElement("div",{className:"app"},r.createElement(_,null,s?r.createElement(r.Fragment,null,r.createElement(b,{to:"/expenses"}),r.createElement(B,{user:s,mobileNavOpen:e,setMobileNavOpen:t}),r.createElement(g,null,r.createElement(v,{path:"/expenses",component:V}),r.createElement(v,{path:"/history/:id",component:D}),r.createElement(v,{path:"/chat/:channelId"},r.createElement(F,{user:s})))):r.createElement(r.Fragment,null,r.createElement(b,{to:"/login"}),r.createElement(v,{path:"/login"},r.createElement($,null)))))}const Q={channelId:"xxiO3R5c7TbsnEXvMnml",channelName:"PFD"},W={user:null},J={popupVisible:!1,navOpen:!1},K=x(f({user:(e=W,t)=>{switch(t.type){case"LOGIN_USER":return s(s({},e),{user:t.payload});case"LOGOUT_USER":return s(s({},e),{user:null});default:return e}},channel:(e=Q,t)=>{switch(t.type){case"SET_CHANNEL":return s(s({},e),{channelId:t.payload.channelId,channelName:t.payload.channelName});default:return e}},app:(e=J,t)=>{switch(t.type){case"TOGGLE_POPUP":return s(s({},e),{popupVisible:!e.popupVisible});case"TOGGLE_NAV":return s(s({},e),{navOpen:!e.navOpen});default:return e}}}),S(O(k)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)),w.render(r.createElement(r.StrictMode,null,r.createElement(P,{store:K},r.createElement(q,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}));
